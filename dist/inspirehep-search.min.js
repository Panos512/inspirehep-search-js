/*
 * This file is part of INSPIRE.
 * Copyright (C) 2016 CERN.
 *
 * INSPIRE is free software; you can redistribute it and/or
 * modify it under the terms of the GNU General Public License as
 * published by the Free Software Foundation; either version 2 of the
 * License, or (at your option) any later version.
 *
 * INSPIRE is distributed in the hope that it will be useful, but
 * WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with INSPIRE; if not, write to the Free Software Foundation, Inc.,
 * 59 Temple Place, Suite 330, Boston, MA 02111-1307, USA.
 *
 * In applying this license, CERN does not
 * waive the privileges and immunities granted to it by virtue of its status
 * as an Intergovernmental Organization or submit itself to any jurisdiction.
 */
!function(e){e.module("claimMode",["claimMode.controllers"])}(angular),function(e){e.module("inspirehepFacetsShowMore",["inspirehepFacetsShowMore.controllers"])}(angular),function(e){e.module("inspirehepSearch",["invenioSearch","inspirehepFacetsShowMore","inspirehepSearch.filters","ui.bootstrap","authors","claimMode"])}(angular),function(e){e.module("authors",["ui.bootstrap","authors.directives","authors.controllers"])}(angular),function(e){e.module("inspirehepSearch.filters",["ngSanitize","inspirehepSearch.filters.abstract","inspirehepSearch.filters.authorInstitution","inspirehepSearch.filters.arxiv","inspirehepSearch.filters.arxivInfo","inspirehepSearch.filters.capitalize","inspirehepSearch.filters.collaboration","inspirehepSearch.filters.corporateAuthor","inspirehepSearch.filters.date","inspirehepSearch.filters.datePassedNow","inspirehepSearch.filters.doi","inspirehepSearch.filters.publicationInfo","inspirehepSearch.filters.publicationInfoDoi","inspirehepSearch.filters.conferenceFormat","inspirehepSearch.filters.journalFormat","inspirehepSearch.filters.reportNumber","inspirehepSearch.filters.title"])}(angular),function(e){function r(e,r,t){function i(){e.vm.ClaimToggled===!1?(e.vm.SwitchColor=!0,window.location.href='/search?page=1&size=25&claim=true&cc=literature&q=author: "'+e.user_full_name+'"'):(e.vm.SwitchColor=!1,t.location.href="/search?claim=false")}function n(t){console.log("Claiming "+t);var i={recordId:t,orcid_id:e.user_orcid_id};r.post("/search/claimRecord",i).then(function(){})}function o(r){return e.vm.claimedRecords?e.vm.claimedRecords.indexOf(r)>=0?!0:!1:!1}function a(r){return e.vm.claimableRecords?e.vm.claimableRecords.indexOf(String(r))>=0?!0:!1:!1}e.vm.ClaimToggled=!1,e.vm.SwitchColor=!1,e.user_is_logged=!1,e.toggleClaim=i,e.vm.claimRecord=n,e.vm.alreadyClaimed=o,e.vm.isClaimable=a,"true"===e.vm.invenioSearchArgs.claim&&(e.vm.SwitchColor=!0,e.vm.ClaimToggled=!0),r.get("/current_user").then(function(t){"found"===t.data.status&&(e.user_is_logged=!0,e.user_full_name=t.data.full_name,e.user_orcid_id=t.data.orcid_id),r({url:"/search/claimedRecords",method:"GET",params:{full_name:e.user_full_name,orcid_id:e.user_orcid_id}}).then(function(r){e.vm.claimedRecords=r.data.records}),r({url:"/search/claimableRecords",method:"GET",params:{full_name:e.user_full_name,orcid_id:e.user_orcid_id}}).then(function(r){e.vm.claimableRecords=r.data.records})})}r.$inject=["$scope","$http","$window"],e.module("claimMode.controllers",[]).controller("claimCtrl",r)}(angular),function(e){function r(e){function r(){e.facetResults=e.facetResults+e.step}function t(r){var t=e.vm.invenioSearchResults.aggregations[r].buckets.length-e.facetResults;return t<e.step?t:e.step}function i(){e.facetResults=10}e.facetResults=10,e.step=10,e.calculateStep=t,e.moreFacetResults=r,e.$on("invenio.search.success",i)}r.$inject=["$scope"],e.module("inspirehepFacetsShowMore.controllers",[]).controller("FacetsShowMoreController",r)}(angular),function(e){function r(){function e(){var e=[];if(void 0!==i.authors){for(var r=0;r<i.authors.length;r++)i.authors[r].full_name&&e.push(t(i.authors[r]));return e}}function r(e){var r=e.split(","),t=r.reverse();return t.join(" ")}function t(e){var r={};return r.full_name=e.full_name,void 0!==e.affiliations&&e.affiliations.length>0&&(r.affiliation=e.affiliations[0].value),r}var i=this;i.getAuthors=e,i.splitAuthorName=r,i.renderAuthorNames=t}r.$inject=["$scope"],e.module("authors.controllers",[]).controller("authorCtrl",r)}(angular),function(e){function r(){function e(e,r,t,i){""!==t.authors&&(i.authors=JSON.parse(t.authors)),""!==t.collaboration&&(i.collaboration=JSON.parse(t.collaboration)),i.numberOfAuthors=parseInt(t.numberOfAuthors),i.controlNumber=parseInt(t.controlNumber),i.AUTHORS_LIMIT=10,i.authorsInfo=i.getAuthors()}function r(e,r){return r.authorsTemplate}return{templateUrl:r,restrict:"E",controller:"authorCtrl",controllerAs:"vm",scope:!0,link:e}}e.module("authors.directives",[]).directive("authorsAffiliation",r)}(angular),function(e){function r(){return function(e){function r(e){return t[e]||e}if(void 0!==e){for(var t={"&":"&amp;","<":"&lt;",">":"&gt;"},i="",n=0;n<e.length;n++)"arXiv"!==e[n].source&&void 0!==e[n].value?i=e[n].value:void 0!==e[n].value&&(i=e[n].value);return i.replace(/[&<>]/g,r)}}}e.module("inspirehepSearch.filters.abstract",[]).filter("abstract",r)}(angular),function(e){function r(){return function(e){if(void 0!==e){for(var r="",t=0;t<e.length;t++){r=e[t].value;break}return r}}}e.module("inspirehepSearch.filters.arxiv",[]).filter("arxiv",r)}(angular),function(e){function r(){return function(e){if(void 0!==e){for(var r="",t="",i=0;i<e.length;i++)r='e-Print: <a href="http://arxiv.org/abs/'+e[i].value+'" >'+e[i].value+"</a>",e[i].categories&&(t="["+e[i].categories[0]+"]");return r+" "+t}}}e.module("inspirehepSearch.filters.arxivInfo",[]).filter("arxivInfo",r)}(angular),function(e){function r(){return function(e){if(void 0!==e){for(var r="",t=0;t<e.length;t++)if("undefined"!=typeof e[t].institution&&"undefined"!=typeof e[t].institution.name){if("undefined"!=typeof e[t].status&&"current"===e[t].status.toLowerCase())return"("+e[t].institution.name+")";r||(r=e[t].institution.name)}return r?"("+r+")":void 0}}}e.module("inspirehepSearch.filters.authorInstitution",[]).filter("authorInstitution",r)}(angular),function(e){function r(){return function(e){return e?e.charAt(0).toUpperCase()+e.slice(1):""}}e.module("inspirehepSearch.filters.capitalize",[]).filter("capitalize",r)}(angular),function(e){function r(){return function(e,r){if(void 0!==e){var t=[],i="";if(!r)for(var n=0;n<e.length;n++)e[n].value&&t.push('<a href="/search?p=collaboration:'+e[n].value+'">'+e[n].value+"</a>");return 0!==t.length&&(i=t.join(" and ")+(t.length>1?" Collaborations":" Collaboration")),i}}}e.module("inspirehepSearch.filters.collaboration",[]).filter("collaboration",r)}(angular),function(e){function r(){return function(e,r){if(void 0!==e){var t="";return e.conference_recid&&e.parent_recid?r?t+=' (<a href="/record/'+e.parent_recid+'">Proceedings</a> of <a href="/record/'+e.conference_recid+'">'+e.conference_title+"</a>)":(t+='Published in <a href="/record/'+e.parent_recid+'">proceedings</a> of <a href="/record/'+e.conference_recid+'">'+e.conference_title+"</a>",e.page_start&&e.page_end&&(t+=", pages "+e.page_start+"-"+e.page_end)):e.conference_recid&&!e.parent_recid?(r&&(t+="<br>"),t+='Contribution to <a href="/record/'+e.conference_recid+'">'+e.conference_title+"</a>"):!e.conference_recid&&e.parent_recid&&(t+=r?' (<a href="/record/'+e.parent_recid+'">Proceedings</a> of '+e.parent_title+")":'Published in <a href="/record/'+e.parent_recid+'">proceedings</a> of '+e.parent_title),t}}}e.module("inspirehepSearch.filters.conferenceFormat",[]).filter("conferenceFormat",r)}(angular),function(e){function r(){return function(e,r){if(void 0!==e);else if(r)return r[0]}}e.module("inspirehepSearch.filters.corporateAuthor",[]).filter("corporateAuthor",r)}(angular),function(e){function r(){return function(e,r,t,i){return void 0===r&&void 0===t&&void 0===i?e:"- "+e}}e.module("inspirehepSearch.filters.date",[]).filter("date",r)}(angular),function(e){function r(){return function(e){var r=new Date,t=new Date(e);return t>=r}}e.module("inspirehepSearch.filters.datePassedNow",[]).filter("datePassedNow",r)}(angular),function(e){function r(){return function(e){if(void 0!==e){for(var r=[],t=0;t<e.length;t++)e[t].value&&r.push('<a href="http://dx.doi.org/'+e[t].value+'" title="DOI" >'+e[t].value+"</a>");return 0!==r.length?"DOI: "+r.join(", "):""}}}e.module("inspirehepSearch.filters.doi",[]).filter("doi",r)}(angular),function(e){function r(){return function(e){if(void 0!==e){var r="";return e.journal_title?(r+="<i>"+e.journal_title+"</i> ",e.journal_volume&&(r+=e.journal_volume),e.year&&(r+=" ("+e.year+")"),e.journal_issue&&(r+=" "+e.journal_issue+","),e.page_start&&e.page_end?r+=" "+e.page_start+"-"+e.page_end:e.page_start?r+=" "+e.page_start:e.artid&&(r+=" "+e.artid)):e.pubinfo_freetext&&(r+=e.pubinfo_freetext),r}}}e.module("inspirehepSearch.filters.journalFormat",[]).filter("journalFormat",r)}(angular),function(e){function r(e,r){return function(t,i){if(void 0!==t){var n,o,a="",l=[];for(n=0,o=t.length;o>n;n++)t[n].journal_title&&l.push(r(t[n]));l&&(a=l.join(" and "));var u="";if(i)for(n=0,o=i.length;o>n;n++)u=e(i[n],l.length),u&&(a+=" "+u);return a&&l.length?"Published in "+a:a}}}e.module("inspirehepSearch.filters.publicationInfo",[]).filter("publicationInfo",r)}(angular),function(e){function r(e,r){return function(t,i,n){if(void 0!==t){var o="Published in ";if(o+='<a href="http://dx.doi.org/'+t[0].value+'" title="DOI"><span class="text-left">'+r(i[0])+"</span></a>",n){var a,l,u="";for(a=0,l=n.length;l>a;a++)if(u=e(n[a],!0)){o+=u;break}}return o}}}e.module("inspirehepSearch.filters.publicationInfoDoi",[]).filter("publicationInfoDoi",r)}(angular),function(e){function r(){return function(e){if(void 0!==e){for(var r=[],t=0;t<e.length;t++)e[t].value&&r.push(" "+e[t].value);return 0!==r.length?"Report number: "+r:""}}}e.module("inspirehepSearch.filters.reportNumber",[]).filter("reportNumber",r)}(angular),function(e){function r(){return function(e){if(void 0!==e){var r="";return void 0!==e.title&&(r=e.title,void 0!==e.subtitle&&(r+=" : "+e.subtitle)),r}}}e.module("inspirehepSearch.filters.title",[]).filter("title",r)}(angular);